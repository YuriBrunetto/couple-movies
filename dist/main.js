$(function(){$(window).load(function(){$("body").removeClass("opacity")}),$(".menu").click(function(){$("#menu-open").toggleClass("active"),$("#menu-close").toggleClass("active")});var t="CoupleMoviesTips",e=window.localStorage.getItem(t);e?$(".tips-container").remove():$("#close-tips").click(function(){$(".tips-container").css("opacity",0),$(".tips-container").one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd oatransitionend transitionend",function(){$(".tips-container").hide("slow",function(){$(".tips-container").remove()})});var e=!0;window.localStorage.setItem(t,e)}),$("#scroll").click(function(){$("html, body").animate({scrollTop:$(".main").offset().top},400)})}),$(function(){var t,e=$(window);e.load(function(){window.localStorage&&o.LoadMovies()}),$("#form").on("submit",function(t){t.preventDefault();var e=$(this).serialize(),i="https://www.omdbapi.com/?"+e+"&type=movie",o="";$.ajax({type:"GET",dataType:"json",url:i,success:function(t){var e={};if(void 0!=t.Search){var i=t.Search.length;if(i){for(var a=0;i>a;a++)e[a]={title:t.Search[a].Title,year:t.Search[a].Year,poster:t.Search[a].Poster},o+='<div class="tips">',"N/A"!=e[a].poster&&(o+='<img src="'+e[a].poster+'" alt="'+e[a].title+'" class="tips-poster">'),o+='<div class="tips-description">',o+='<h3><strong data-movie="title">'+e[a].title+'</strong> <span data-movie="year">'+e[a].year+"</span></h3><br>",o+="</div>",o+='<a href="javascript:;" class="tips-add">add to list <i class="fa fa-check" aria-hidden="true"></i></a>',o+="</div>";$("#results").html(o)}}else $("#results").html("<p class='no-movies'>No matches found.</p>")}})});var i=function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}();$("#t").on("keydown",function(){t=$(this),i(function(){t.submit()},1e3)});var o={};o.SaveTo="CoupleMovies",$("body").delegate(".tips-add","click",function(){t=$(this).parent().find(".tips-description");var e={title:t.find("strong[data-movie='title']").text(),year:t.find("span[data-movie='year']").text(),poster:$(this).parent().find("img").attr("src")};o.SaveMovie(o.SaveTo,e)}),$("body").delegate(".tips-remove","click",function(){t=$(this).parent(),t.css("opacity","0").one("webkitTransitionEnd transitionend",function(){t.hide(300,function(){o.DeleteMovie(t)})})}),o.SaveMovie=function(t,e){for(var i=localStorage.getItem(t)||"[]",a=JSON.parse(i)||[],n=a.concat(e),s=n.length-1,r=!1,c=0;c<a.length;c++)n[s].title==a[c].title&&(r=!0);r?($("#notification-exists").addClass("active"),setTimeout(function(){$("#notification-exists").removeClass("active")},3e3)):(window.localStorage.setItem(t,JSON.stringify(n)),o.LoadMovies(),$("#notification-added").addClass("active"),setTimeout(function(){$("#notification-added").removeClass("active")},3e3))},o.LoadMovies=function(){var t,e,i=window.localStorage.getItem(o.SaveTo);if(i)if(e=JSON.parse(i),e.length>=1){for(var a in e){var n=e[a];t+='<div class="tips">',void 0!=n.poster&&(t+='<img src="'+n.poster+'" alt="'+n.title+'" class="tips-poster">'),t+='<div class="tips-description">',t+='<h3><strong data-movie="title">'+n.title+'</strong> <span data-movie="year">'+n.year+"</span></h3><br>",t+="</div>",t+='<a href="javascript:;" class="tips-remove">remove</a>',t+="</div>"}t=t.replace("undefined",""),$("#my-list").html(t)}else $("#my-list").html("<p class='no-movies'>There are no movies on your list.</p>");else $("#my-list").html("<p class='no-movies'>There are no movies on your list.</p>")},o.DeleteMovie=function(t){var e=t.find("strong[data-movie='title']").text(),i=JSON.parse(localStorage.getItem(o.SaveTo)),a=$.grep(i,function(t){return t.title!==e});window.localStorage.setItem(o.SaveTo,JSON.stringify(a)),setTimeout(function(){o.LoadMovies(),$("#notification-del").addClass("active"),setTimeout(function(){$("#notification-del").removeClass("active")},3e3)},1e3)}});